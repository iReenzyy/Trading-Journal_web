<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–π–¥–µ—Ä–∞</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –¥–æ–±–∞–≤–ª—è—é –Ω–æ–≤—ã–π –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å */
        @media (min-width: 768px) {
            h1 {
                font-size: 3rem; /* –£–≤–µ–ª–∏—á–∏–ª –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
                margin-bottom: 20px;
            }
            .form-label {
                font-size: 1rem; /* –£–≤–µ–ª–∏—á–∏–ª –º–µ—Ç–∫–∏ —Ñ–æ—Ä–º */
            }
            .form-control, .form-select {
                font-size: 1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ */
                height: 40px;
            }
            .btn {
                font-size: 1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–æ–∫ */
                padding: 8px 16px;
            }
            .btn-action {
                font-size: 0.9rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç –¥–µ–π—Å—Ç–≤–∏–π */
                padding: 5px 8px;
            }
            .btn-add-coin, .btn-add-image {
                font-size: 1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è */
                padding: 5px 10px;
            }
            .table {
                font-size: 1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ */
            }
            .table th, .table td {
                padding: 8px; /* –£–≤–µ–ª–∏—á–∏–ª –æ—Ç—Å—Ç—É–ø—ã –≤ —è—á–µ–π–∫–∞—Ö */
            }
            .navbar-brand {
                font-size: 1.1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
                padding: 10px 15px;
            }
            #stats h3 {
                font-size: 1.8rem; /* –£–≤–µ–ª–∏—á–∏–ª –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
                margin-bottom: 10px;
            }
            #stats p {
                font-size: 1.1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
                margin: 8px 0;
            }
            #stats span {
                font-size: 1.2rem; /* –£–≤–µ–ª–∏—á–∏–ª –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ */
            }
            .range-label {
                font-size: 0.9rem; /* –£–≤–µ–ª–∏—á–∏–ª –º–µ—Ç–∫–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ */
            }
            .range-value {
                font-size: 0.9rem; /* –£–≤–µ–ª–∏—á–∏–ª –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ */
                padding: 3px 8px;
            }
            input[type="range"] {
                height: 10px; /* –ù–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏–ª –ø–æ–ª–∑—É–Ω–æ–∫ */
            }
            input[type="range"]::-webkit-slider-thumb {
                width: 18px;
                height: 18px;
            }
            input[type="range"]::-moz-range-thumb {
                width: 18px;
                height: 18px;
            }
            .preview-image {
                max-height: 200px; /* –£–≤–µ–ª–∏—á–∏–ª —Ä–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π */
                margin-top: 10px;
            }
            .progress-bar {
                height: 20px; /* –£–≤–µ–ª–∏—á–∏–ª –≤—ã—Å–æ—Ç—É –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ */
                font-size: 1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ */
            }
            .progress-bar span {
                line-height: 20px;
            }
            .notification {
                font-size: 1.1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
                padding: 10px 20px;
            }
            .theme-switch {
                width: 40px;
                height: 40px;
            }
            .theme-switch i {
                font-size: 1.2rem;
            }
            .lang-switch {
                font-size: 1rem; /* –£–≤–µ–ª–∏—á–∏–ª —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —è–∑—ã–∫–∞ */
                height: 40px;
                padding: 5px;
            }
        }
    
        /* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        @media (max-width: 768px) {
            h1 { font-size: 1.2rem; margin-bottom: 10px; }
            .container { padding: 5px; }
            .card { padding: 8px; margin-bottom: 8px; }
            .form-label { font-size: 0.7rem; }
            .form-control, .form-select { height: 30px; font-size: 0.8rem; }
            .btn { padding: 5px 10px; font-size: 0.8rem; }
            .btn-action { padding: 3px 5px; font-size: 0.6rem; margin: 0 1px; }
            .btn-add-coin, .btn-add-image { padding: 3px 6px; font-size: 0.8rem; margin-left: 3px; }
            .table { font-size: 0.7rem; }
            .table th, .table td { padding: 4px; }
            .navbar { padding: 5px 0; }
            .navbar-brand { font-size: 0.8rem; padding: 6px 10px; margin: 0 3px; }
            #stats { padding: 8px; }
            #stats h3 { font-size: 1.2rem; margin-bottom: 6px; }
            #stats p { font-size: 0.8rem; margin: 4px 0; }
            #stats span { font-size: 0.9rem; }
            .range-label { font-size: 0.6rem; }
            .range-value { top: -20px; padding: 1px 4px; font-size: 0.6rem; }
            input[type="range"] { height: 6px; }
            input[type="range"]::-webkit-slider-thumb { width: 12px; height: 12px; }
            input[type="range"]::-moz-range-thumb { width: 12px; height: 12px; }
            .preview-image { max-height: 100px; margin-top: 5px; }
            .progress-bar { height: 12px; margin-bottom: 8px; font-size: 0.7rem; }
            .progress-bar span { line-height: 12px; }
            .theme-switch { width: 30px; height: 30px; }
            .theme-switch i { font-size: 0.9rem; }
            .lang-switch { height: 30px; padding: 3px; font-size: 0.8rem; }
            .notification { top: 10px; right: 10px; padding: 6px 12px; font-size: 0.8rem; }
        }
    
        /* –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: linear-gradient(135deg, #1E2A44 0%, #0F172A 100%);
            color: #ECF0F1;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }
        body.light {
            background: linear-gradient(135deg, #F0F4F8 0%, #D9E2EC 100%);
            color: #333;
        }
        .container {
            padding: 10px;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
            background: linear-gradient(90deg, #00F7FF, #FF00E6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: fadeIn 1.5s ease-in-out;
        }
        h1.light {
            background: linear-gradient(90deg, #007BFF, #FF1493);
        }
        .card {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
            transition: transform 0.3s ease;
        }
        .card.light {
            background: rgba(240, 244, 248, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 247, 255, 0.2);
        }
        .card.light:hover {
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.2);
        }
        .form-control, .form-select {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #FFFFFF;
            border-radius: 4px;
            transition: all 0.3s ease;
            height: 35px;
            font-size: 0.9rem;
        }
        .form-control.light, .form-select.light {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
            color: #333;
        }
        .form-control:focus, .form-select:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: #00F7FF;
            box-shadow: 0 0 5px rgba(0, 247, 255, 0.5);
            color: #FFFFFF;
        }
        .form-control.light:focus, .form-select.light:focus {
            background: rgba(0, 0, 0, 0.1);
            border-color: #007BFF;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
            color: #333;
        }
        .form-select option {
            background: #1E2A44;
            color: #FFFFFF;
        }
        .form-select.light option {
            background: #F0F4F8;
            color: #333;
        }
        .form-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: #A0B1C5;
        }
        .form-label.light {
            color: #555;
        }
        .btn {
            background: linear-gradient(90deg, #00F7FF, #FF00E6);
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            box-shadow: 0 0 5px rgba(0, 247, 255, 0.5);
        }
        .btn.light {
            background: linear-gradient(90deg, #FFF5E1, #FF9999);
            box-shadow: 0 0 5px rgba(255, 153, 153, 0.5);
        }
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(0, 247, 255, 0.8);
        }
        .btn.light:hover {
            box-shadow: 0 0 10px rgba(255, 153, 153, 0.8);
        }
        .btn-action {
            background: #1E2A44;
            color: #00F7FF;
            border: 1px solid #00F7FF;
            padding: 4px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin: 0 2px;
            transition: all 0.3s ease;
            display: inline-block;
        }
        .btn-action.light {
            background: #D9E2EC;
            color: #007BFF;
            border: 1px solid #007BFF;
        }
        .btn-action:hover {
            background: #00F7FF;
            color: #1E2A44;
            box-shadow: 0 0 5px #00F7FF;
        }
        .btn-action.light:hover {
            background: #007BFF;
            color: #D9E2EC;
            box-shadow: 0 0 5px #007BFF;
        }
        .btn-add-coin, .btn-add-image {
            background: #00F7FF;
            color: #1E2A44;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.9rem;
            margin-left: 5px;
            transition: all 0.3s ease;
        }
        .btn-add-coin.light, .btn-add-image.light {
            background: #007BFF;
            color: #F0F4F8;
        }
        .btn-add-coin:hover, .btn-add-image:hover {
            background: #FF00E6;
            color: #FFFFFF;
            box-shadow: 0 0 5px #FF00E6;
        }
        .btn-add-coin.light:hover, .btn-add-image.light:hover {
            background: #FF1493;
            box-shadow: 0 0 5px #FF1493;
        }
        .table {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 8px;
            width: 100%;
            table-layout: auto;
            overflow-x: auto;
            font-size: 0.9rem;
        }
        .table.light {
            background: rgba(240, 244, 248, 0.9);
        }
        .table th {
            background: rgba(255, 255, 255, 0.1);
            color: #00F7FF;
            text-transform: uppercase;
            font-size: 0.8rem;
            text-align: center;
            padding: 6px;
            cursor: pointer;
            white-space: nowrap;
            overflow: visible;
            text-overflow: clip;
        }
        .table th:nth-child(7), /* –£–±—ã—Ç–æ–∫ ($) */
        .table th:nth-child(8), /* –ò—Ç–æ–≥ (%) */
        .table th:nth-child(9)  /* –°–µ—Ç–∞–ø */
        {
            padding-right: 4px;
            padding-left: 4px;
        }
        .table th:first-child {
            border-top-left-radius: 8px;
        }
        .table th:last-child {
            border-top-right-radius: 8px;
        }
        .table.light th {
            background: rgba(0, 0, 0, 0.1);
            color: #007BFF;
        }
        .table th:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        .table.light th:hover {
            background: rgba(0, 0, 0, 0.2);
        }
        .table td {
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #FFFFFF;
            text-align: center;
            padding: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 0.8rem;
        }
        .table td:nth-child(7), /* –£–±—ã—Ç–æ–∫ ($) */
        .table td:nth-child(8), /* –ò—Ç–æ–≥ (%) */
        .table td:nth-child(9)  /* –°–µ—Ç–∞–ø */
        {
            padding-right: 4px;
            padding-left: 4px;
        }
        .table td:nth-child(9), /* –°–µ—Ç–∞–ø */
        .table td:nth-child(10) /* –ó–∞–º–µ—Ç–∫–∏ */
        {
            padding: 0;
            padding-top: 10px; /* –°–º–µ—â–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ "–ü–æ–¥—Ä–æ–±–Ω–µ–µ" */
        }
        .table td:nth-child(4) {
            text-overflow: clip;
            overflow: visible;
        }
        .table td.actions-cell {
            white-space: nowrap;
        }
        .table td:first-child {
            border-bottom-left-radius: 8px;
        }
        .table td:last-child {
            border-bottom-right-radius: 8px;
        }
        .table.light td {
            background: rgba(0, 0, 0, 0.05);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            color: #333;
        }
        .table td.setup-cell, .table td.notes-cell {
            overflow: hidden;
            text-overflow: ellipsis;
            padding-top: 10px; /* –°–º–µ—â–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ "–ü–æ–¥—Ä–æ–±–Ω–µ–µ" */
        }
        .table td.setup-cell:hover, .table td.notes-cell:hover {
            overflow: visible;
            white-space: normal;
        }
        .navbar {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 8px 0;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        .navbar.light {
            background: rgba(240, 244, 248, 0.9);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        .navbar-brand {
            background: linear-gradient(90deg, #00F7FF, #FF00E6);
            color: #1E2A44;
            font-size: 1rem;
            padding: 8px 12px;
            border-radius: 15px;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 247, 255, 0.3);
            margin: 0 5px;
            text-decoration: none;
            display: inline-block;
        }
        .navbar-brand.light {
            background: linear-gradient(90deg, #FFFFFF, #FF9999);
            color: #333;
            box-shadow: 0 2px 5px rgba(255, 153, 153, 0.3);
        }
        .navbar-brand:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(0, 247, 255, 0.5);
        }
        .navbar-brand.light:hover {
            box-shadow: 0 4px 10px rgba(255, 153, 153, 0.5);
        }
        .navbar-brand.active {
            background: linear-gradient(90deg, #FF00E6, #00F7FF);
            color: #1E2A44;
            box-shadow: 0 4px 10px rgba(255, 0, 230, 0.5);
        }
        .navbar-brand.light.active {
            background: linear-gradient(90deg, #FF9999, #FFFFFF);
            box-shadow: 0 4px 10px rgba(255, 153, 204, 0.5);
        }
        #stats {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(15px);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: none;
        }
        #stats.light {
            background: rgba(240, 244, 248, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }
        #stats h3 {
            color: #00F7FF;
            margin-bottom: 8px;
            font-size: 1.5rem;
        }
        #stats.light h3 {
            color: #007BFF;
        }
        #stats p {
            margin: 6px 0;
            font-size: 0.9rem;
            color: #A0B1C5;
        }
        #stats.light p {
            color: #555;
        }
        #stats span {
            color: #00F7FF;
            font-weight: bold;
            font-size: 1rem;
        }
        #stats.light span {
            color: #007BFF;
        }
        .range-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: #A0B1C5;
            margin-top: 5px;
            position: relative;
        }
        .range-label.light {
            color: #555;
        }
        .range-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 247, 255, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            color: #00F7FF;
        }
        .range-value.light {
            background: rgba(0, 123, 255, 0.2);
            color: #007BFF;
        }
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, #00F7FF, #FF00E6);
            border-radius: 4px;
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        input[type="range"].light {
            background: linear-gradient(90deg, #007BFF, #FF1493);
        }
        input[type="range"]:hover {
            opacity: 1;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            background: #00F7FF;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 5px #00F7FF;
            transition: transform 0.1s ease;
        }
        input[type="range"].light::-webkit-slider-thumb {
            background: #007BFF;
            box-shadow: 0 0 5px #007BFF;
        }
        input[type="range"]::-moz-range-thumb {
            width: 15px;
            height: 15px;
            background: #00F7FF;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 5px #00F7FF;
            transition: transform 0.1s ease;
        }
        input[type="range"].light::-moz-range-thumb {
            background: #007BFF;
            box-shadow: 0 0 5px #007BFF;
        }
        .modal-content {
            background: rgba(15, 23, 42, 0.9);
            color: #ECF0F1;
            border: 1px solid #00F7FF;
            border-radius: 8px;
        }
        .modal-content.light {
            background: rgba(240, 244, 248, 0.9);
            color: #333;
            border: 1px solid #007BFF;
        }
        .modal-header {
            border-bottom: 1px solid #00F7FF;
        }
        .modal-header.light {
            border-bottom: 1px solid #007BFF;
        }
        .modal-footer {
            border-top: 1px solid #00F7FF;
        }
        .modal-footer.light {
            border-top: 1px solid #007BFF;
        }
        .preview-image {
            max-width: 100%;
            max-height: 150px;
            margin-top: 8px;
            border-radius: 4px;
            border: 1px solid #00F7FF;
        }
        .preview-image.light {
            border: 1px solid #007BFF;
        }
        .progress-bar {
            height: 15px;
            background: linear-gradient(90deg, #00F7FF, #FF00E6);
            border-radius: 8px;
            margin-bottom: 10px;
            text-align: center;
            color: #1E2A44;
            font-weight: bold;
            font-size: 0.8rem;
        }
        .progress-bar.light {
            background: linear-gradient(90deg, #007BFF, #FF1493);
        }
        .progress-bar span {
            line-height: 15px;
        }
        [data-tooltip] {
            position: relative;
        }
        [data-tooltip]:hover:after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(30, 42, 68, 0.9);
            color: #ECF0F1;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            white-space: nowrap;
            z-index: 1;
        }
        [data-tooltip].light:hover:after {
            background: rgba(217, 226, 236, 0.9);
            color: #333;
        }
        .notification {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(0, 247, 255, 0.9);
            color: #1E2A44;
            padding: 8px 15px;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0, 247, 255, 0.5);
            z-index: 1000;
            display: none;
            font-size: 0.9rem;
            animation: fadeInOut 3s ease-in-out;
        }
        .notification.light {
            background: rgba(0, 123, 255, 0.9);
            box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
        }
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(-20px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
        .theme-switch {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 35px;
            height: 35px;
            background: #00F7FF;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .theme-switch.light {
            background: #007BFF;
        }
        .theme-switch:hover {
            background: #FF00E6;
            color: #FFFFFF;
            box-shadow: 0 0 5px #FF00E6;
        }
        .theme-switch.light:hover {
            background: #FF1493;
            box-shadow: 0 0 5px #FF1493;
        }
        .theme-switch i {
            font-size: 1rem;
            color: #1E2A44;
        }
        .theme-switch.light i {
            color: #F0F4F8;
        }
        .lang-switch {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #FFFFFF;
            border-radius: 4px;
            transition: all 0.3s ease;
            height: 35px;
            padding: 4px;
            font-size: 0.9rem;
        }
        .lang-switch.light {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
            color: #333;
        }
        .lang-switch:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: #00F7FF;
            box-shadow: 0 0 5px rgba(0, 247, 255, 0.5);
            color: #FFFFFF;
        }
        .lang-switch.light:focus {
            background: rgba(0, 0, 0, 0.1);
            border-color: #007BFF;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
            color: #333;
        }
        .lang-switch option {
            background: #1E2A44;
            color: #FFFFFF;
        }
        .lang-switch.light option {
            background: #F0F4F8;
            color: #333;
        }
        .lang-switch option[selected] {
            background: #00F7FF;
            color: #1E2A44;
            font-weight: bold;
        }
        .lang-switch.light option[selected] {
            background: #007BFF;
            color: #F0F4F8;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <select class="lang-switch" onchange="setLanguage(this.value)">
            <option value="ru" selected>–†—É—Å—Å–∫–∏–π</option>
            <option value="en">English</option>
        </select>
        <h1 class="fade-in"><i class="fas fa-chart-line"></i> <span data-i18n="title">–î–ù–ï–í–ù–ò–ö –¢–†–ï–ô–î–ï–†–ê</span></h1>
        <button class="theme-switch" onclick="toggleTheme()"><i class="fas fa-lightbulb"></i></button>

        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–¥–µ–ª–∫–∏ -->
        <div id="main" class="card fade-in">
            <div class="row mb-2">
                <div class="col-6">
                    <label for="coin" class="form-label" data-tooltip="–í—ã–±–µ—Ä–∏—Ç–µ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –º–æ–Ω–µ—Ç—É" data-i18n="coinLabel">–ú–æ–Ω–µ—Ç–∞</label>
                    <div class="d-flex">
                        <select class="form-select" id="coin" required>
                            <option value="BTCUSD">BTCUSD</option>
                            <option value="ETHUSD">ETHUSD</option>
                            <option value="XRPUSD">XRPUSD</option>
                        </select>
                        <button class="btn-add-coin" onclick="promptAddCoin()" data-tooltip="–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –º–æ–Ω–µ—Ç—É" data-i18n="addCoin">+</button>
                    </div>
                </div>
                <div class="col-6">
                    <label for="position" class="form-label" data-tooltip="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–∑–∏—Ü–∏–∏" data-i18n="positionLabel">–ü–æ–∑–∏—Ü–∏—è</label>
                    <select class="form-select" id="position" required>
                        <option value="Short">Short</option>
                        <option value="Long">Long</option>
                    </select>
                </div>
            </div>
            <div class="row mb-2">
                <div class="col-6">
                    <label for="open_date" class="form-label" data-tooltip="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –æ—Ç–∫—Ä—ã—Ç–∏—è —Å–¥–µ–ª–∫–∏" data-i18n="openDateLabel">–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è</label>
                    <input type="date" class="form-control" id="open_date" required>
                </div>
                <div class="col-6">
                    <label for="risk" class="form-label" data-tooltip="–í–≤–µ–¥–∏—Ç–µ —Ä–∏—Å–∫ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö" data-i18n="riskLabel">–†–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É ($)</label>
                    <input type="number" step="0.01" class="form-control" id="risk" required>
                </div>
            </div>
            <div class="row mb-2">
                <div class="col-6">
                    <label for="profit" class="form-label" data-tooltip="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–±—ã–ª—å –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö" data-i18n="profitLabel">–ü—Ä–∏–±—ã–ª—å ($)</label>
                    <input type="number" step="0.01" class="form-control" id="profit" required>
                </div>
                <div class="col-6">
                    <label for="loss" class="form-label" data-tooltip="–í–≤–µ–¥–∏—Ç–µ —É–±—ã—Ç–æ–∫ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö" data-i18n="lossLabel">–£–±—ã—Ç–æ–∫ ($)</label>
                    <input type="number" step="0.01" class="form-control" id="loss" required>
                </div>
            </div>
            <div class="row mb-2">
                <div class="col-6">
                    <label for="result" class="form-label" data-tooltip="–í–≤–µ–¥–∏—Ç–µ –∏—Ç–æ–≥ —Å–¥–µ–ª–∫–∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö" data-i18n="resultLabel">–ò—Ç–æ–≥ —Å–¥–µ–ª–∫–∏ (%)</label>
                    <input type="number" step="0.01" class="form-control" id="result" required>
                </div>
                <div class="col-6">
                    <label for="notes" class="form-label" data-tooltip="–î–æ–±–∞–≤—å—Ç–µ –∑–∞–º–µ—Ç–∫–∏ –∫ —Å–¥–µ–ª–∫–µ" data-i18n="notesLabel">–ó–∞–º–µ—Ç–∫–∏</label>
                    <div class="d-flex">
                        <input type="text" class="form-control" id="notes">
                        <button class="btn-add-image" onclick="document.getElementById('notesImage').click()" data-tooltip="–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–º–µ—Ç–æ–∫" data-i18n="addImage">üì∑</button>
                        <input type="file" class="form-control d-none" id="notesImage" accept="image/*" onchange="handleNotesImageUpload(event)">
                    </div>
                    <img id="notesImagePreview" class="preview-image" style="display: none;">
                </div>
            </div>
            <div class="row mb-2">
                <div class="col-12">
                    <label for="setup" class="form-label" data-tooltip="–û–ø–∏—à–∏—Ç–µ —Å–µ—Ç–∞–ø —Å–¥–µ–ª–∫–∏" data-i18n="setupLabel">–°–µ—Ç–∞–ø</label>
                    <div class="d-flex">
                        <input type="text" class="form-control" id="setup" required style="height: 60px; resize: vertical;">
                        <button class="btn-add-image" onclick="document.getElementById('setupImage').click()" data-tooltip="–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Å–µ—Ç–∞–ø–∞" data-i18n="addImage">üì∑</button>
                        <input type="file" class="form-control d-none" id="setupImage" accept="image/*" onchange="handleSetupImageUpload(event)">
                    </div>
                    <img id="setupImagePreview" class="preview-image" style="display: none;">
                </div>
            </div>
            <div class="row mb-2">
                <div class="col-12">
                    <label for="rating" class="form-label" data-tooltip="–û—Ü–µ–Ω–∏—Ç–µ —Å–¥–µ–ª–∫—É –æ—Ç 1 –¥–æ 5" data-i18n="ratingLabel">–û—Ü–µ–Ω–∫–∞ (1-5)</label>
                    <div class="range-label">
                        <span>1</span>
                        <span>2</span>
                        <span>3</span>
                        <span>4</span>
                        <span>5</span>
                        <div class="range-value" id="ratingValue">1</div>
                    </div>
                    <input type="range" class="form-range" id="rating" min="1" max="5" step="0.01" value="1" oninput="updateRatingSmoothly(this)">
                </div>
            </div>
            <button class="btn w-100" id="submitBtn" onclick="saveTrade()" data-tooltip="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Å–¥–µ–ª–∫—É" data-i18n="submitBtn"><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Å–¥–µ–ª–∫—É</button>
            <button class="btn w-100 mt-2" id="cancelBtn" style="display: none;" onclick="cancelEdit()" data-tooltip="–û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ" data-i18n="cancelBtn">–û—Ç–º–µ–Ω–∞</button>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ —Å–¥–µ–ª–æ–∫ -->
        <div id="view" class="card fade-in">
            <h3 class="text-center mb-2" style="font-size: 1.5rem; background: linear-gradient(90deg, #00F7FF, #FF00E6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;" data-i18n="myTrades">–ú–æ–∏ —Å–¥–µ–ª–∫–∏</h3>
            <div class="progress-bar" id="successProgress"><span>0%</span></div>
            <div class="row mb-2">
                <div class="col-6">
                    <label for="filterCoin" class="form-label" data-i18n="filterCoinLabel">–§–∏–ª—å—Ç—Ä –ø–æ –º–æ–Ω–µ—Ç–µ</label>
                    <select class="form-select" id="filterCoin" onchange="applyFilters()">
                        <option value="">–í—Å–µ</option>
                    </select>
                </div>
                <div class="col-6">
                    <label for="filterPosition" class="form-label" data-i18n="filterPositionLabel">–§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–∑–∏—Ü–∏–∏</label>
                    <select class="form-select" id="filterPosition" onchange="applyFilters()">
                        <option value="">–í—Å–µ</option>
                        <option value="Short">Short</option>
                        <option value="Long">Long</option>
                    </select>
                </div>
            </div>
            <table class="table table-striped" id="tradesTable">
                <thead>
                    <tr>
                        <th data-sort="id" data-i18n="id">ID</th>
                        <th data-sort="coin" data-i18n="coin">–ú–æ–Ω–µ—Ç–∞</th>
                        <th data-sort="position" data-i18n="position">–ü–æ–∑–∏—Ü–∏—è</th>
                        <th data-sort="open_date" data-i18n="date">–î–∞—Ç–∞</th>
                        <th data-sort="risk" data-i18n="risk">–†–∏—Å–∫ ($)</th>
                        <th data-sort="profit" data-i18n="profit">–ü—Ä–∏–±—ã–ª—å ($)</th>
                        <th data-sort="loss" data-i18n="loss">–£–±—ã—Ç–æ–∫ ($)</th>
                        <th data-sort="result" data-i18n="result">–ò—Ç–æ–≥ (%)</th>
                        <th data-i18n="setup">–°–µ—Ç–∞–ø</th>
                        <th data-i18n="notes">–ó–∞–º–µ—Ç–∫–∏</th>
                        <th data-sort="rating" data-i18n="rating">–û—Ü–µ–Ω–∫–∞</th>
                        <th data-sort="actions" data-i18n="actions">–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="tradesBody"></tbody>
            </table>
            <div class="row mt-2">
                <div class="col-6">
                    <button class="btn w-100" onclick="exportToCSV()" data-tooltip="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ CSV" data-i18n="exportCSV">–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</button>
                </div>
                <div class="col-6">
                    <button class="btn w-100" onclick="exportToPDF()" data-tooltip="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ PDF" data-i18n="exportPDF">–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF</button>
                </div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div id="stats" class="card fade-in">
            <h3 class="text-center mb-2" data-i18n="stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <p data-i18n="totalTrades">–í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫: <span id="totalTrades">0</span></p>
            <p data-i18n="avgProfit">–°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å: <span id="avgProfit">0.00</span>$</p>
            <p data-i18n="avgLoss">–°—Ä–µ–¥–Ω–∏–π —É–±—ã—Ç–æ–∫: <span id="avgLoss">0.00</span>$</p>
            <p data-i18n="avgResult">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <span id="avgResult">0.00</span>%</p>
            <p data-i18n="successRate">–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫: <span id="successRate">0</span>%</p>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è "–°–µ—Ç–∞–ø" –∏ "–ó–∞–º–µ—Ç–∫–∏" -->
        <div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="detailModalLabel" data-i18n="details">–î–µ—Ç–∞–ª–∏</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="detailModalBody">
                        <!-- –¢–µ–∫—Å—Ç –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥—É—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-action" data-bs-dismiss="modal" data-i18n="close">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div class="notification" id="notification"></div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
    <nav class="navbar navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#" onclick="showSection('main')" data-i18n="home"><i class="fas fa-home"></i> –ì–ª–∞–≤–Ω–∞—è</a>
            <a class="navbar-brand active" href="#" onclick="showSection('view')" data-i18n="myTradesNav"><i class="fas fa-table"></i> –ú–æ–∏ —Å–¥–µ–ª–∫–∏</a>
            <a class="navbar-brand" href="#" onclick="showSection('stats')" data-i18n="statsNav"><i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
        </div>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // JSON –¥–ª—è –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç–∏
        const translations = {
            "ru": {
                "title": "–î–ù–ï–í–ù–ò–ö –¢–†–ï–ô–î–ï–†–ê",
                "coinLabel": "–ú–æ–Ω–µ—Ç–∞",
                "addCoin": "+",
                "positionLabel": "–ü–æ–∑–∏—Ü–∏—è",
                "openDateLabel": "–î–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è",
                "riskLabel": "–†–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É ($)",
                "profitLabel": "–ü—Ä–∏–±—ã–ª—å ($)",
                "lossLabel": "–£–±—ã—Ç–æ–∫ ($)",
                "resultLabel": "–ò—Ç–æ–≥ —Å–¥–µ–ª–∫–∏ (%)",
                "notesLabel": "–ó–∞–º–µ—Ç–∫–∏",
                "addImage": "üì∑",
                "setupLabel": "–°–µ—Ç–∞–ø",
                "ratingLabel": "–û—Ü–µ–Ω–∫–∞ (1-5)",
                "submitBtn": "–î–æ–±–∞–≤–∏—Ç—å —Å–¥–µ–ª–∫—É",
                "cancelBtn": "–û—Ç–º–µ–Ω–∞",
                "myTrades": "–ú–æ–∏ —Å–¥–µ–ª–∫–∏",
                "filterCoinLabel": "–§–∏–ª—å—Ç—Ä –ø–æ –º–æ–Ω–µ—Ç–µ",
                "filterPositionLabel": "–§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–∑–∏—Ü–∏–∏",
                "id": "ID",
                "coin": "–ú–æ–Ω–µ—Ç–∞",
                "position": "–ü–æ–∑–∏—Ü–∏—è",
                "date": "–î–∞—Ç–∞",
                "risk": "–†–∏—Å–∫ ($)",
                "profit": "–ü—Ä–∏–±—ã–ª—å ($)",
                "loss": "–£–±—ã—Ç–æ–∫ ($)",
                "result": "–ò—Ç–æ–≥ (%)",
                "setup": "–°–µ—Ç–∞–ø",
                "notes": "–ó–∞–º–µ—Ç–∫–∏",
                "rating": "–û—Ü–µ–Ω–∫–∞",
                "actions": "–î–µ–π—Å—Ç–≤–∏—è",
                "exportCSV": "–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV",
                "exportPDF": "–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF",
                "stats": "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                "totalTrades": "–í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫:",
                "avgProfit": "–°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å:",
                "avgLoss": "–°—Ä–µ–¥–Ω–∏–π —É–±—ã—Ç–æ–∫:",
                "avgResult": "–°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:",
                "successRate": "–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫:",
                "details": "–î–µ—Ç–∞–ª–∏",
                "close": "–ó–∞–∫—Ä—ã—Ç—å",
                "home": "–ì–ª–∞–≤–Ω–∞—è",
                "myTradesNav": "–ú–æ–∏ —Å–¥–µ–ª–∫–∏",
                "statsNav": "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                "isRequired": "–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è",
                "cannotBeNegative": "–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º",
                "confirmEdit": "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è?",
                "tradeUpdated": "–°–¥–µ–ª–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!",
                "tradeAdded": "–°–¥–µ–ª–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!",
                "confirmDelete": "–£–¥–∞–ª–∏—Ç—å —Å–¥–µ–ª–∫—É —Å ID",
                "tradeDeleted": "–°–¥–µ–ª–∫–∞ —É–¥–∞–ª–µ–Ω–∞!",
                "noTradesToExport": "–ù–µ—Ç —Å–¥–µ–ª–æ–∫ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞!",
                "exportedToCSV": "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ CSV!",
                "exportedToPDF": "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ PDF!",
                "detailsBtn": "–ü–æ–¥—Ä–æ–±–Ω–µ–µ",
                "edit": "–†–µ–¥.",
                "delete": "–£–¥–∞–ª."
            },
            "en": {
                "title": "TRADER'S JOURNAL",
                "coinLabel": "Coin",
                "addCoin": "+",
                "positionLabel": "Position",
                "openDateLabel": "Open Date",
                "riskLabel": "Risk ($)",
                "profitLabel": "Profit ($)",
                "lossLabel": "Loss ($)",
                "resultLabel": "Result (%)",
                "notesLabel": "Notes",
                "addImage": "üì∑",
                "setupLabel": "Setup",
                "ratingLabel": "Rating (1-5)",
                "submitBtn": "Add Trade",
                "cancelBtn": "Cancel",
                "myTrades": "My Trades",
                "filterCoinLabel": "Filter by Coin",
                "filterPositionLabel": "Filter by Position",
                "id": "ID",
                "coin": "Coin",
                "position": "Position",
                "date": "Date",
                "risk": "Risk ($)",
                "profit": "Profit ($)",
                "loss": "Loss ($)",
                "result": "Result (%)",
                "setup": "Setup",
                "notes": "Notes",
                "rating": "Rating",
                "actions": "Actions",
                "exportCSV": "Export to CSV",
                "exportPDF": "Export to PDF",
                "stats": "Statistics",
                "totalTrades": "Total Trades:",
                "avgProfit": "Average Profit:",
                "avgLoss": "Average Loss:",
                "avgResult": "Average Result:",
                "successRate": "Success Rate:",
                "details": "Details",
                "close": "Close",
                "home": "Home",
                "myTradesNav": "My Trades",
                "statsNav": "Statistics",
                "isRequired": "is required",
                "cannotBeNegative": "cannot be negative",
                "confirmEdit": "Are you sure you want to save changes?",
                "tradeUpdated": "Trade updated!",
                "tradeAdded": "Trade added!",
                "confirmDelete": "Delete trade with ID",
                "tradeDeleted": "Trade deleted!",
                "noTradesToExport": "No trades to export!",
                "exportedToCSV": "Exported to CSV!",
                "exportedToPDF": "Exported to PDF!",
                "detailsBtn": "Details",
                "edit": "Edit",
                "delete": "Delete"
            }
        };
        let currentLang = localStorage.getItem("lang") || "ru";

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem("lang", lang);
            document.querySelectorAll("[data-i18n]").forEach(element => {
                const key = element.getAttribute("data-i18n");
                element.textContent = translations[lang][key] || element.textContent;
            });
            updateTable();
            updateStats();
            document.querySelector(".lang-switch").value = lang;
        }

        let trades = JSON.parse(localStorage.getItem("trades")) || [];
        let coins = JSON.parse(localStorage.getItem("coins")) || ["BTCUSD", "ETHUSD", "XRPUSD"];
        let images = JSON.parse(localStorage.getItem("images")) || {};
        let editingTradeId = null;
        let filters = JSON.parse(localStorage.getItem("filters")) || { coin: "", position: "" };
        let sortColumn = null;
        let sortDirection = 1;

        function updateRatingSmoothly(input) {
            let targetValue = parseFloat(input.value);
            let currentValue = parseFloat(input.value);
            let start = null;

            function animate(timestamp) {
                if (!start) start = timestamp;
                let progress = timestamp - start;
                let duration = 200;
                let ease = progress / duration;
                if (ease > 1) ease = 1;

                let newValue = currentValue + (targetValue - currentValue) * ease;
                input.value = Math.round(newValue * 100) / 100;
                document.getElementById("ratingValue").textContent = newValue.toFixed(2);
                if (progress < duration) {
                    requestAnimationFrame(animate);
                }
            }
            requestAnimationFrame(animate);
        }

        function compressImage(file, callback) {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = function(e) {
                const img = new Image();
                img.src = e.target.result;
                img.onload = function() {
                    const canvas = document.createElement("canvas");
                    const ctx = canvas.getContext("2d");
                    const maxWidth = 800;
                    const maxHeight = 600;
                    let width = img.width;
                    let height = img.height;

                    if (width > height) {
                        if (width > maxWidth) {
                            height = Math.round((height * maxWidth) / width);
                            width = maxWidth;
                        }
                    } else {
                        if (height > maxHeight) {
                            width = Math.round((width * maxHeight) / height);
                            height = maxHeight;
                        }
                    }

                    canvas.width = width;
                    canvas.height = height;
                    ctx.drawImage(img, 0, 0, width, height);
                    const compressedImage = canvas.toDataURL("image/jpeg", 0.7);
                    callback(compressedImage);
                };
            };
        }

        function handleSetupImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                compressImage(file, compressedImage => {
                    images["setupImage"] = compressedImage;
                    localStorage.setItem("images", JSON.stringify(images));
                    document.getElementById("setupImagePreview").src = compressedImage;
                    document.getElementById("setupImagePreview").style.display = "block";
                    showNotification("Image uploaded successfully!");
                });
            }
        }

        function handleNotesImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                compressImage(file, compressedImage => {
                    images["notesImage"] = compressedImage;
                    localStorage.setItem("images", JSON.stringify(images));
                    document.getElementById("notesImagePreview").src = compressedImage;
                    document.getElementById("notesImagePreview").style.display = "block";
                    showNotification("Image uploaded successfully!");
                });
            }
        }

        function promptAddCoin() {
            const newCoin = prompt(translations[currentLang]["coinLabel"] + ":");
            if (newCoin && newCoin.trim() && !coins.includes(newCoin.trim())) {
                coins.push(newCoin.trim());
                localStorage.setItem("coins", JSON.stringify(coins));
                updateCoinSelect();
                updateFilterCoinOptions();
                showNotification(translations[currentLang]["coinLabel"] + " added!");
            } else if (newCoin && coins.includes(newCoin.trim())) {
                showNotification(translations[currentLang]["coinLabel"] + " already exists!");
            } else {
                showNotification(translations[currentLang]["coinLabel"] + " cannot be empty!");
            }
        }

        function updateCoinSelect() {
            const select = document.getElementById("coin");
            select.innerHTML = "";
            coins.forEach(coin => {
                const option = document.createElement("option");
                option.value = coin;
                option.textContent = coin;
                select.appendChild(option);
            });
        }

        function updateFilterCoinOptions() {
            const filterCoin = document.getElementById("filterCoin");
            filterCoin.innerHTML = '<option value="">' + translations[currentLang]["filterCoinLabel"].split(" ")[0] + '</option>';
            coins.forEach(coin => {
                const option = document.createElement("option");
                option.value = coin;
                option.textContent = coin;
                filterCoin.appendChild(option);
            });
            filterCoin.value = filters.coin;
        }

        function applyFilters() {
            filters.coin = document.getElementById("filterCoin").value;
            filters.position = document.getElementById("filterPosition").value;
            localStorage.setItem("filters", JSON.stringify(filters));
            updateTable();
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}.${month}.${year}`;
        }

        function sortTable(column) {
            if (sortColumn === column) {
                sortDirection *= -1;
            } else {
                sortColumn = column;
                sortDirection = 1;
            }
            trades.sort((a, b) => {
                let valA = a[column];
                let valB = b[column];
                if (column === "open_date") {
                    valA = new Date(a[column]);
                    valB = new Date(b[column]);
                } else if (["risk", "profit", "loss", "result", "rating"].includes(column)) {
                    valA = parseFloat(a[column]);
                    valB = parseFloat(b[column]);
                }
                return valA > valB ? sortDirection : valA < valB ? -sortDirection : 0;
            });
            localStorage.setItem("trades", JSON.stringify(trades));
            updateTable();
        }

        function validateForm() {
            const requiredFields = ["coin", "position", "open_date", "risk", "profit", "loss", "result", "setup"];
            for (let field of requiredFields) {
                const value = document.getElementById(field).value.trim();
                if (!value) {
                    showNotification(`${document.querySelector(`label[for="${field}"]`).textContent} ${translations[currentLang]["isRequired"]}!`);
                    return false;
                }
            }

            const numericFields = ["risk", "profit", "loss"];
            for (let field of numericFields) {
                const value = parseFloat(document.getElementById(field).value);
                if (value < 0) {
                    showNotification(`${document.querySelector(`label[for="${field}"]`).textContent} ${translations[currentLang]["cannotBeNegative"]}!`);
                    return false;
                }
            }

            return true;
        }

        function editTrade(id) {
            const trade = trades.find(t => t.id === id);
            if (trade) {
                editingTradeId = id;
                document.getElementById("coin").value = trade.coin;
                document.getElementById("position").value = trade.position;
                document.getElementById("open_date").value = trade.open_date;
                document.getElementById("risk").value = trade.risk;
                document.getElementById("profit").value = trade.profit;
                document.getElementById("loss").value = trade.loss;
                document.getElementById("result").value = trade.result;
                document.getElementById("setup").value = trade.setup;
                document.getElementById("notes").value = trade.notes || "";
                document.getElementById("rating").value = trade.rating;
                document.getElementById("ratingValue").textContent = trade.rating.toFixed(2);
                document.getElementById("setupImage").value = "";
                document.getElementById("notesImage").value = "";
                images = {
                    "setupImage": trade.setupImage || "",
                    "notesImage": trade.notesImage || ""
                };
                localStorage.setItem("images", JSON.stringify(images));
                if (trade.setupImage) {
                    document.getElementById("setupImagePreview").src = trade.setupImage;
                    document.getElementById("setupImagePreview").style.display = "block";
                }
                if (trade.notesImage) {
                    document.getElementById("notesImagePreview").src = trade.notesImage;
                    document.getElementById("notesImagePreview").style.display = "block";
                }

                document.getElementById("submitBtn").textContent = translations[currentLang]["submitBtnEdit"] || "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è";
                document.getElementById("cancelBtn").style.display = "block";
                showSection('main');
            }
        }

        function saveTrade() {
            if (!validateForm()) return;

            if (editingTradeId && !confirm(translations[currentLang]["confirmEdit"])) {
                return;
            }

            if (editingTradeId) {
                const tradeIndex = trades.findIndex(t => t.id === editingTradeId);
                if (tradeIndex !== -1) {
                    const updatedTrade = {
                        id: editingTradeId,
                        coin: document.getElementById("coin").value,
                        position: document.getElementById("position").value,
                        open_date: document.getElementById("open_date").value,
                        risk: parseFloat(document.getElementById("risk").value) || 0,
                        profit: parseFloat(document.getElementById("profit").value) || 0,
                        loss: parseFloat(document.getElementById("loss").value) || 0,
                        result: parseFloat(document.getElementById("result").value) || 0,
                        setup: document.getElementById("setup").value,
                        notes: document.getElementById("notes").value,
                        rating: parseFloat(document.getElementById("rating").value) || 1,
                        setupImage: images["setupImage"] || "",
                        notesImage: images["notesImage"] || ""
                    };
                    trades[tradeIndex] = updatedTrade;
                    localStorage.setItem("trades", JSON.stringify(trades));
                    showNotification(translations[currentLang]["tradeUpdated"]);
                }
                editingTradeId = null;
                document.getElementById("submitBtn").textContent = translations[currentLang]["submitBtn"];
                document.getElementById("cancelBtn").style.display = "none";
            } else {
                const trade = {
                    id: trades.length + 1,
                    coin: document.getElementById("coin").value,
                    position: document.getElementById("position").value,
                    open_date: document.getElementById("open_date").value,
                    risk: parseFloat(document.getElementById("risk").value) || 0,
                    profit: parseFloat(document.getElementById("profit").value) || 0,
                    loss: parseFloat(document.getElementById("loss").value) || 0,
                    result: parseFloat(document.getElementById("result").value) || 0,
                    setup: document.getElementById("setup").value,
                    notes: document.getElementById("notes").value,
                    rating: parseFloat(document.getElementById("rating").value) || 1,
                    setupImage: images["setupImage"] || "",
                    notesImage: images["notesImage"] || ""
                };
                trades.push(trade);
                localStorage.setItem("trades", JSON.stringify(trades));
                showNotification(translations[currentLang]["tradeAdded"]);
            }
            clearForm();
            updateTable();
            updateStats();
            autoSave();
        }

        function cancelEdit() {
            editingTradeId = null;
            clearForm();
            document.getElementById("submitBtn").textContent = translations[currentLang]["submitBtn"];
            document.getElementById("cancelBtn").style.display = "none";
            showSection('main');
        }

        function clearForm() {
            document.getElementById("coin").value = "BTCUSD";
            document.getElementById("position").value = "Short";
            document.getElementById("open_date").value = new Date().toISOString().split('T')[0];
            document.getElementById("risk").value = "";
            document.getElementById("profit").value = "";
            document.getElementById("loss").value = "";
            document.getElementById("result").value = "";
            document.getElementById("setup").value = "";
            document.getElementById("notes").value = "";
            document.getElementById("rating").value = "1";
            document.getElementById("ratingValue").textContent = "1";
            document.getElementById("setupImage").value = "";
            document.getElementById("notesImage").value = "";
            document.getElementById("setupImagePreview").style.display = "none";
            document.getElementById("notesImagePreview").style.display = "none";
            images = {};
            localStorage.setItem("images", JSON.stringify(images));
        }

        function updateTable() {
            const tbody = document.getElementById("tradesBody");
            tbody.innerHTML = "";
            const filteredTrades = trades.filter(trade => {
                const matchesCoin = filters.coin ? trade.coin === filters.coin : true;
                const matchesPosition = filters.position ? trade.position === filters.position : true;
                return matchesCoin && matchesPosition;
            });
            filteredTrades.forEach(trade => {
                const row = document.createElement("tr");
                row.classList.add("fade-in");
                row.innerHTML = `
                    <td>${trade.id}</td>
                    <td>${trade.coin}</td>
                    <td>${trade.position}</td>
                    <td>${formatDate(trade.open_date)}</td>
                    <td>${trade.risk.toFixed(2)}</td>
                    <td>${trade.profit.toFixed(2)}</td>
                    <td>${trade.loss.toFixed(2)}</td>
                    <td>${trade.result.toFixed(2)}</td>
                    <td class="setup-cell"><button class="btn-action btn-sm" onclick="showDetailModal(${trade.id}, 'setup')" data-i18n="detailsBtn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button></td>
                    <td class="notes-cell"><button class="btn-action btn-sm" onclick="showDetailModal(${trade.id}, 'notes')" data-i18n="detailsBtn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button></td>
                    <td>${trade.rating.toFixed(2)}</td>
                    <td class="actions-cell">
                        <button class="btn-action btn-sm" onclick="editTrade(${trade.id})" data-i18n="edit">–†–µ–¥.</button>
                        <button class="btn-action btn-sm" onclick="deleteTrade(${trade.id})" data-i18n="delete">–£–¥–∞–ª.</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            updateProgressBar();
            document.querySelectorAll("#tradesBody .btn-action").forEach(btn => {
                const key = btn.getAttribute("data-i18n");
                if (key) btn.textContent = translations[currentLang][key];
            });
        }

        function updateProgressBar() {
            const successRate = parseFloat(document.getElementById("successRate").textContent) || 0;
            const progressBar = document.getElementById("successProgress");
            progressBar.style.width = `${successRate}%`;
            progressBar.firstChild.textContent = `${successRate.toFixed(2)}%`;
        }

        function updateStats() {
            const totalTrades = trades.length;
            const avgProfit = trades.length ? (trades.reduce((sum, trade) => sum + trade.profit, 0) / trades.length).toFixed(2) : 0;
            const avgLoss = trades.length ? (trades.reduce((sum, trade) => sum + trade.loss, 0) / trades.length).toFixed(2) : 0;
            const avgResult = trades.length ? (trades.reduce((sum, trade) => sum + trade.result, 0) / trades.length).toFixed(2) : 0;
            const successRate = trades.length ? (trades.filter(trade => trade.result > 0).length / trades.length * 100).toFixed(2) : 0;

            document.getElementById("totalTrades").textContent = totalTrades;
            document.getElementById("avgProfit").textContent = avgProfit;
            document.getElementById("avgLoss").textContent = avgLoss;
            document.getElementById("avgResult").textContent = avgResult;
            document.getElementById("successRate").textContent = successRate;
            updateProgressBar();
        }

        function showDetailModal(id, type) {
            const trade = trades.find(t => t.id === id);
            if (trade) {
                const modalBody = document.getElementById("detailModalBody");
                modalBody.innerHTML = "";
                if (type === "setup") {
                    modalBody.innerHTML = `<p>${trade.setup || "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"}</p>`;
                    if (trade.setupImage) {
                        const img = document.createElement("img");
                        img.src = trade.setupImage;
                        img.classList.add("preview-image");
                        modalBody.appendChild(img);
                    }
                } else if (type === "notes") {
                    modalBody.innerHTML = `<p>${trade.notes || "–ù–µ—Ç –∑–∞–º–µ—Ç–æ–∫"}</p>`;
                    if (trade.notesImage) {
                        const img = document.createElement("img");
                        img.src = trade.notesImage;
                        img.classList.add("preview-image");
                        modalBody.appendChild(img);
                    }
                }
                const modal = new bootstrap.Modal(document.getElementById("detailModal"));
                modal.show();
            }
        }

        function deleteTrade(id) {
            if (confirm(`${translations[currentLang]["confirmDelete"]} ${id}?`)) {
                trades = trades.filter(trade => trade.id !== id);
                trades = trades.map((trade, index) => ({ ...trade, id: index + 1 }));
                localStorage.setItem("trades", JSON.stringify(trades));
                updateTable();
                updateStats();
                showNotification(translations[currentLang]["tradeDeleted"]);
            }
        }

        function exportToCSV() {
            if (!trades.length) {
                showNotification(translations[currentLang]["noTradesToExport"]);
                return;
            }
            const headers = ["ID", "Coin", "Position", "Date", "Risk ($)", "Profit ($)", "Loss ($)", "Result (%)", "Setup", "Notes", "Rating"];
            const rows = trades.map(trade => [
                trade.id,
                trade.coin,
                trade.position,
                formatDate(trade.open_date),
                trade.risk,
                trade.profit,
                trade.loss,
                trade.result,
                `"${trade.setup.replace(/"/g, '""')}"`,
                `"${trade.notes ? trade.notes.replace(/"/g, '""') : ""}"`,
                trade.rating
            ]);
            const csvContent = [headers.join(","), ...rows.map(row => row.join(","))].join("\n");
            const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "trades.csv";
            link.click();
            showNotification(translations[currentLang]["exportedToCSV"]);
        }

        function exportToPDF() {
            if (!trades.length) {
                showNotification(translations[currentLang]["noTradesToExport"]);
                return;
            }
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFontSize(16);
            doc.text(translations[currentLang]["myTrades"], 10, 10);
            doc.setFontSize(12);
            const headers = [["ID", "Coin", "Position", "Date", "Risk ($)", "Profit ($)", "Loss ($)", "Result (%)", "Rating"]];
            const data = trades.map(trade => [
                trade.id,
                trade.coin,
                trade.position,
                formatDate(trade.open_date),
                trade.risk.toFixed(2),
                trade.profit.toFixed(2),
                trade.loss.toFixed(2),
                trade.result.toFixed(2),
                trade.rating.toFixed(2)
            ]);
            doc.autoTable({
                head: headers,
                body: data,
                startY: 20,
                theme: "grid",
                styles: { fontSize: 10 }
            });
            doc.save("trades.pdf");
            showNotification(translations[currentLang]["exportedToPDF"]);
        }

        function showNotification(message) {
            const notification = document.getElementById("notification");
            notification.textContent = message;
            notification.style.display = "block";
            setTimeout(() => {
                notification.style.display = "none";
            }, 3000);
        }

        function autoSave() {
            localStorage.setItem("trades", JSON.stringify(trades));
            localStorage.setItem("coins", JSON.stringify(coins));
            localStorage.setItem("images", JSON.stringify(images));
        }

        function toggleTheme() {
            document.body.classList.toggle("light");
            document.querySelectorAll(".card, .form-control, .form-select, .table, .btn, .btn-action, .btn-add-coin, .btn-add-image, .navbar, .modal-content, .modal-header, .modal-footer, .preview-image, .progress-bar, .notification, .theme-switch, .lang-switch, .range-label, .range-value, input[type='range'], [data-tooltip]").forEach(element => {
                element.classList.toggle("light");
            });
            localStorage.setItem("theme", document.body.classList.contains("light") ? "light" : "dark");
        }

        function showSection(sectionId) {
            document.querySelectorAll("#main, #view, #stats").forEach(section => {
                section.style.display = section.id === sectionId ? "block" : "none";
            });
            document.querySelectorAll(".navbar-brand").forEach(btn => {
                btn.classList.toggle("active", btn.getAttribute("onclick").includes(sectionId));
            });
            if (sectionId === "stats") {
                updateStats(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ä–∞–∑–¥–µ–ª–∞
                document.getElementById("stats").style.display = "block";
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            if (localStorage.getItem("theme") === "light") {
                toggleTheme();
            }
            setLanguage(currentLang);
            updateCoinSelect();
            updateFilterCoinOptions();
            document.getElementById("filterCoin").value = filters.coin;
            document.getElementById("filterPosition").value = filters.position;
            updateTable();
            updateStats(); // –í—ã–∑—ã–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            showSection("view");

            document.querySelectorAll("#tradesTable th[data-sort]").forEach(th => {
                th.addEventListener("click", () => sortTable(th.getAttribute("data-sort")));
            });
        });
    </script>
</body>
</html>
